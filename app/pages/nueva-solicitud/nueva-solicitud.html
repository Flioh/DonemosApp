<!-- Custom navbar -->
<navbar [ocultarIconoNuevaSolicitud]="ocultarIcono()" [titulo]="setTitulo()"></navbar>

<ion-content padding class="nueva-solicitud">
	<ion-list>
		<form [ngFormModel]="nuevaSolicitudForm">

			<!-- Institucion  -->
			<ion-item [class.submitted]="submitted" [class.invalid]="!ctrlInstitucion.valid">
				<ion-label stacked>Institucion</ion-label>
				<ion-input id="autocomplete" [(ngModel)]="institucionValue" ngControl="institucion" type="text" placeholder="Ejemplo: Hospital Cullen"></ion-input>
			</ion-item>
			<span *ngIf="submitted && !ctrlInstitucion.valid" class="mensaje-error">
				Ingrese el nombre de la institución.
			</span>

			<!-- Dirección  -->
			<ion-item [class.submitted]="submitted" [class.invalid]="!ctrlDireccion.valid">
				<ion-label floating>Direccion</ion-label>
				<ion-input [(ngModel)]="direccionValue" ngControl="direccion" type="text"></ion-input>
			</ion-item>
			<span *ngIf="submitted && !ctrlDireccion.valid" class="mensaje-error">
				Ingrese la dirección.
			</span>

			<!-- Provincia  -->
			<ion-item [class.submitted]="submitted" [class.invalid]="!provinciaValue">
				<ion-label floating>Provincia</ion-label>
				<ion-select [(ngModel)]="provinciaValue" ngControl="provincia" okText="Aceptar" cancelText="Cancelar" (ionChange)="inicializarCiudadesDeLaProvincia()">
			    	<ion-option *ngFor="let provincia of listaProvincias" value={{provincia.key}}>{{provincia.value}}</ion-option>
				</ion-select>
			</ion-item>
			<span *ngIf="submitted && !provinciaValue" class="mensaje-error">
				Seleccione una provincia.
			</span>

			<!-- Ciudad  -->
			<ion-item [class.submitted]="submitted" [class.invalid]="!ciudadValue">
				<ion-label floating>Ciudad</ion-label>
				<ion-select [(ngModel)]="ciudadValue" ngControl="ciudad" okText="Aceptar" cancelText="Cancelar">
			    	<ion-option *ngFor="let ciudad of listaCiudades" value={{ciudad.key}}>{{ciudad.value}}</ion-option>
				</ion-select>
			</ion-item>
			<span *ngIf="submitted && !ciudadValue" class="mensaje-error">
				Seleccione una ciudad.
			</span>

			<!-- Hora desde -->
			<ion-item [class.submitted]="submitted" [class.invalid]="!ctrlHoraDesde.valid">
			  <ion-label>Desde las</ion-label>
			  <ion-datetime displayFormat="HH:mm" [(ngModel)]="horaDesdeValue" ngControl="horaDesde">
			  </ion-datetime>
			</ion-item>
			<span *ngIf="submitted && !ctrlHoraDesde.valid" class="mensaje-error">
				Ingrese la hora de inicio.
			</span>

			<!-- Hora hasta -->
			<ion-item [class.submitted]="submitted" [class.invalid]="!ctrlHoraHasta.valid">
			  <ion-label>Hasta las</ion-label>
			  <ion-datetime displayFormat="HH:mm" [(ngModel)]="horaHastaValue" ngControl="horaHasta">
			  </ion-datetime>
			</ion-item>
			<span *ngIf="submitted && !ctrlHoraHasta.valid" class="mensaje-error">
				Ingrese la hora de fin.
			</span>

			<!-- Grupo -->
			<ion-item class="half-size" [class.submitted]="submitted" [class.invalid]="!grupoValue">
				<ion-label floating>Grupo</ion-label>
				<ion-select [(ngModel)]="grupoValue" ngControl="grupo" okText="Aceptar" cancelText="Cancelar">
			    	<ion-option *ngFor="let grupo of listaGruposSanguineos" value={{grupo.key}}>{{grupo.value}}</ion-option>
				</ion-select>
			</ion-item>

			<!-- Factor -->
			<ion-item class="half-size" [class.submitted]="submitted" [class.invalid]="!factorValue">
				<ion-label floating>Factor</ion-label>
				<ion-select [(ngModel)]="factorValue" ngControl="factor" okText="Aceptar" cancelText="Cancelar">
			    	<ion-option *ngFor="let factor of listaFactoresSanguineos" value={{factor.key}}>{{factor.value}}</ion-option>
				</ion-select>
			</ion-item>
			<span *ngIf="submitted && (!grupoValue || !factorValue)" class="mensaje-error">
				Seleccione un grupo y un factor.
			</span>

			<!-- Cantidad  -->
			<ion-item [class.submitted]="submitted" [class.invalid]="!ctrlCantidad.valid">
				<ion-label floating>Cantidad</ion-label>
				<ion-input [(ngModel)]="cantidadValue" ngControl="cantidad" type="number"></ion-input>
			</ion-item>

			<!-- Datos adicionales  -->
			<ion-item [class.submitted]="submitted" [class.invalid]="!ctrlDatosAdicionales.valid">
				<ion-label floating>Datos adicionales</ion-label>
				<ion-textarea [(ngModel)]="datosAdicionalesValue" ngControl="datosAdicionales"></ion-textarea>
			</ion-item>

			<ion-item>
				<h3>Value:</h3>
				<pre>{{contenidoDelFormulario}}</pre>
				<pre>Validity: {{nuevaSolicitudForm.valid}}</pre>
			</ion-item>

		</form>

		<button class="submit" (click)="guardarCambios()" red>Crear Solicitud</button>

	</ion-list>

</ion-content>


