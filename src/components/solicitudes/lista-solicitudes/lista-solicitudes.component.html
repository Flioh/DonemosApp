<ion-header no-shadow>
	<ion-navbar color="negro">
		<ion-title><img class="logo" src="assets/images/logo_principal.png" alt=""></ion-title>
		
		<button ion-button menuToggle="right" end>
			<ion-icon name="menu"></ion-icon>
		</button>

		<ion-buttons *ngIf="isIos" end>
			<button ion-button (click)="nuevaSolicitud()"><ion-icon name="add"></ion-icon></button>
		</ion-buttons>
	</ion-navbar>

	<ion-toolbar>
		<ion-segment color="blanco" [(ngModel)]="seccion">
			<ion-segment-button value="solicitudes">
				Solicitudes
			</ion-segment-button>
			<ion-segment-button value="filtros" (ionSelect)="inicializarFiltros()">
				Filtros
			</ion-segment-button>
		</ion-segment>
	</ion-toolbar>

	

</ion-header>

<ion-content [class.fondo-oscuro]="seccion === 'solicitudes'" padding>

	<div [ngSwitch]="seccion">

		<!-- Seccion de solicitudes -->
		<div *ngSwitchCase="'solicitudes'">


			<!-- Bancos de sangre -->
			<ion-card class="resumen-banco-sangre">

				<!-- Layout para cuando es compatible -->
				<ion-item text-wrap class="encabezado">
					<h2> 
						<strong>Siempre</strong>
						<span> se necesitan dadores</span>
					</h2>
					<h3 class="desc-tipos-sanguineos">De todo tipo.</h3>
					<ion-icon  class="icono-compatibilidad" name="checkmark-circle-outline" color="principalOscuro"></ion-icon>
				</ion-item>

				<ion-card-content class="detalle-solicitud">
					<ion-row>
						<ion-col>
							Si sólo <strong>1 de cada 20 argentinos</strong> donasen voluntariamente, se cubriría toda la demanda necesaria.
						</ion-col>			
					</ion-row>
					<ion-row>
						<ion-col width-25>
						</ion-col>
						<ion-col class="ver-detalles" tappable width-75 (click)="mostrarListaBancosSangre()">
							VER DONDE DONAR <ion-icon name="arrow-forward"></ion-icon>
						</ion-col>
					</ion-row>
				</ion-card-content>
			</ion-card>




			<!-- Creamos una lista de solicitudes usando el componente solicitud-item -->
			<resumen-solicitud *ngFor="let solicitudItemModel of solicitudes" 
				[solicitudItemModel]="solicitudItemModel"
				(seleccionarSolicitud)="abrirDetalles($event)">		
			</resumen-solicitud>

			<ion-fab *ngIf="!isIos">
				<button ion-fab class="floating-btn" color="principal" fab (click)="nuevaSolicitud()"><ion-icon name="add"></ion-icon></button>
			</ion-fab>

			<button *ngIf="hayMasSolicitudes" class="submit" color="principal" full (click)="buscarSolicitudes()">
				Ver mas solicitudes
			</button>
		</div>
			
		<!-- Seccion de filtros de busqueda -->
		<ion-list *ngSwitchCase="'filtros'">
			<form #filtros="ngForm">



				<!-- Provincia  -->
				<ion-item (click)="abrirModalProvincias()">
					<ion-label stacked>Provincia</ion-label>
					<ion-input disabled [value]="provinciaSeleccionada?.nombre"> </ion-input>	
				</ion-item>



				<!-- Localidad  -->
				<ion-item (click)="abrirModalLocalidades()">
					<ion-label stacked>Localidad</ion-label>
					<ion-input disabled [value]="localidadSeleccionada?.nombre"> </ion-input>	
				</ion-item>



				<!-- Grupo sanguineo  -->
				<ion-item>
					<ion-label floating>Tu grupo sanguineo</ion-label>
					<ion-select [(ngModel)]="grupoSanguineoSeleccionado" okText="Aceptar" cancelText="Cancelar" name="grupo" #grupo="ngModel">
						<ion-option *ngFor="let grupo of listaGruposSanguineos" [value]="grupo.id">
							{{grupo.nombre}}
						</ion-option>
					</ion-select>
				</ion-item>



				<!-- Factor sanguineo  -->
				<ion-item>
					<ion-label floating>Tu factor sanguineo</ion-label>
					<ion-select [(ngModel)]="factorSanguineoSeleccionado" okText="Aceptar" cancelText="Cancelar" name="factor" #factor="ngModel">
						<ion-option *ngFor="let factor of listaFactoresSanguineos" [value]="factor.id">
							{{factor.nombre}}
						</ion-option>
					</ion-select>
				</ion-item>



				<!-- Toggle para usar datos personales como filtro -->
				<ion-item *ngIf="datosUsuarioObj">
				    <ion-label>Usar mis preferencias</ion-label>
				    <ion-toggle color="negro" [(ngModel)]="usarDatosPersonales" (ionChange)="usarDatosUsuario()" name="usarDatosPersonales"></ion-toggle>
				</ion-item>
				<ion-item text-wrap *ngIf="!datosUsuarioObj">
					<p>Si desea puede configurar sus preferencias en <strong>Configurar preferencias</strong> para luego poder utilizarlas automáticamente como filtro de búsqueda.</p>
				</ion-item>				

			</form>

			<button ion-button class="btn-inline btn-secondary reset" color="grisOscuro" full (click)="borrarFiltros()">
				Borrar
			</button>

			<button ion-button class="btn-inline btn-primary" (click)="buscarSolicitudes()" color="principal" full>
				Buscar Solicitudes
			</button>
				
		</ion-list>
	</div>

</ion-content>
